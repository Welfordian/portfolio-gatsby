{"version":3,"file":"component---src-components-watch-together-app-js-32654f92ca0b289682e0.js","mappings":"8NAsBA,MAtBMA,WACF,aACIC,KAAKC,SAAW,GACnB,kBAgBA,OAhBA,EAEDC,KAAA,SAAKC,EAAWC,IACND,KAAaH,KAAKC,UAExBD,KAAKC,SAASE,GAAWE,SAAQ,SAAAC,GAC7BA,EAAGF,OAEV,EAEDG,GAAA,SAAGJ,EAAWK,GACHL,KAAaH,KAAKC,WACrBD,KAAKC,SAASE,GAAa,IAG/BH,KAAKC,SAASE,GAAWM,KAAKD,IACjC,EAnBCT,ICEeW,EAAAA,WACjB,WAAYC,EAAKC,GAAS,IAAD,OACrBZ,KAAKW,IAAMA,EACXX,KAAKY,OAASA,EAEdZ,KAAKa,UACLb,KAAKc,aAELd,KAAKY,OAAOG,OAAM,SAACC,EAAOC,GAClBD,KAAS,GACT,EAAKA,GAAOC,MAGvB,kBAiDA,OAjDA,EAEDJ,QAAA,WAAW,IAAD,OACNb,KAAKY,OAAOL,GAAG,WAAW,WACtB,EAAKI,IAAIO,SAAS,CAAEC,WAAW,QAEtC,EAEDL,WAAA,WAAc,IAAD,OACTd,KAAKY,OAAOL,GAAG,cAAc,WACzB,EAAKI,IAAIO,SAAS,CAAEC,WAAW,QAEtC,EAEDC,aAAA,YAAoB,IAANC,EAAK,EAALA,GACVtB,EAAAA,KAAc,eAAgB,CAACsB,GAAAA,KAClC,EAEDC,eAAA,WACIvB,EAAAA,KAAc,mBACjB,EAEDwB,iBAAA,YAA2D,IAAzCC,EAAwC,EAAxCA,KAAMC,EAAkC,EAAlCA,MAAOC,EAA2B,EAA3BA,SAAUC,EAAiB,EAAjBA,QAASC,EAAQ,EAARA,MAC1CC,EAAUJ,IAAUC,EACxB3B,EAAAA,KAAc,mBAAoB,CAAC8B,QAAAA,EAASL,KAAAA,EAAMC,MAAAA,EAAOC,SAAAA,EAAUC,QAAAA,EAASC,MAAAA,KAC/E,EAEDE,eAAA,SAAeC,GACXhC,EAAAA,KAAc,eAAd,eAA+BiC,iBAAiB,GAASD,KAC5D,EAEDE,aAAA,SAAaF,GACThC,EAAAA,KAAc,eAAgBgC,IACjC,EAEDG,kBAAA,YAA6B,IAAVC,EAAS,EAATA,OACfC,MAAMD,IACT,EAEDE,eAAA,SAAeb,GACXzB,EAAAA,KAAc,iBAAkByB,IACnC,EAEDc,qBAAA,YAAwD,EAAlCb,MAAkC,EAA3BC,SAA2B,EAAjBC,QAAkB,IAATC,EAAQ,EAARA,MAC5C7B,EAAAA,KAAc,kBAAmB,CAAEwC,OAAQC,OAAOC,KAAKb,GAAOc,UACjE,EAEDC,sBAAA,YAAwC,EAAjBhB,QAAkB,IAATC,EAAQ,EAARA,MAC5B7B,EAAAA,KAAc,kBAAmB,CAAEwC,OAAQC,OAAOC,KAAKb,GAAOc,UACjE,EA9DgBhC,GCAAkC,EAAAA,WACjB,WAAYjC,EAAKC,GACbZ,KAAKW,IAAMA,EACXX,KAAKY,OAASA,EACjB,kBAiBA,OAjBA,EAEDE,WAAA,WACId,KAAKY,OAAOE,cACf,EAED+B,SAAA,SAASxB,GACLrB,KAAKY,OAAOV,KAAK,eAAgB,CAACmB,GAAAA,IAClCtB,EAAAA,KAAc,eAAgB,CAACsB,GAAAA,KAClC,EAEDyB,SAAA,SAASC,GACL/C,KAAKY,OAAOV,KAAK,YAAa,CAAC6C,QAAAA,KAClC,EAEDC,WAAA,SAAWxB,EAAMtB,QAAc,IAAdA,IAAAA,GAAO,GACpBF,KAAKY,OAAOV,KAAK,iBAAkB,CAACsB,KAAAA,EAAMtB,KAAAA,KAC7C,EArBgB0C,G,2DC+GrB,EA3GMK,SAAAA,GACF,WAAYC,GAAQ,IAAD,SACf,cAAMA,IAAN,MAEKC,MAAQ,CACTzB,SAAU,KACVa,OAAQ,EACRR,KAAM,GACNqB,aAAc,IAAIR,GAAJ,UAAuB,EAAKM,MAAMtC,SAGpDb,EAAAA,GAAY,oBAAoB,YAA8C,IAA5CyB,EAA2C,EAA3CA,KAAMC,EAAqC,EAArCA,MAAOC,EAA8B,EAA9BA,SAAUC,EAAoB,EAApBA,QAASC,EAAW,EAAXA,MAC9D,EAAKV,SAAS,CAAEW,QAASJ,EAAOC,SAAAA,EAAU2B,UAAW7B,EAAMG,QAAAA,EAASY,OAAQC,OAAOC,KAAKb,GAAOc,YAGnG3C,EAAAA,GAAY,gBAAgB,SAAAgC,GACxB,EAAKuB,SAAL,iBAAkBvB,EAAlB,CAAwBwB,KAAMxB,EAAKyB,SAAW,EAAKL,MAAMzB,eAG7D3B,EAAAA,GAAY,mBAAmB,YAAe,IAAbwC,EAAY,EAAZA,OAC7B,EAAKrB,SAAS,CAAEqB,OAAAA,OAGpBxC,EAAAA,GAAY,kBAAkB,WAC1B,EAAKmB,SAAS,CAACa,KAAM,QAvBV,GADjBkB,EAAAA,EAAAA,GAAAA,EAAAA,GA0BD,kBA8EA,OA9EA,EAEDH,SAAA,SAASW,GACL,IAAIV,EAAUU,EAAEC,OAAOC,MAEvB3D,KAAK4D,eAEL5D,KAAKmD,MAAMC,aAAaN,SAASC,IACpC,EAEDa,aAAA,WACI5D,KAAKkB,SAAS,CACV2C,YAAa,MAEpB,EAEDP,SAAA,SAASvB,GACL/B,KAAKkB,SAAS,CACVa,KAAK,CAAEA,GAAH,eAAY/B,KAAKmD,MAAMpB,UAElC,EAED+B,OAAA,WAAW,IAAD,OACN,OACI,uBAAKC,UAAU,2HACX,uBAAKA,UAAS,wBACV,uBAAKA,UAAS,QAEN/D,KAAKmD,MAAMtB,QAEP,uBAAKkC,UAAS,QACV,uBAAKC,QAAS,kBAAM,EAAKC,eAEjBjE,KAAKkD,MAAMgB,SAEP,gBAAC,IAAD,CAAiBC,MAAK,cAAiBC,KAAMC,EAAAA,MAE7C,gBAAC,IAAD,CAAiBF,MAAK,YAAeC,KAAME,EAAAA,QAK3D,IAIZ,qBAAGP,UAAU,cAAe/D,KAAKmD,MAAMZ,OAAvC,gBAGJ,uBAAKwB,UAAS,4CACV,yBACIQ,aAAY,MACZZ,MAAO3D,KAAKmD,MAAMU,YAClBW,YAAW,kBACXC,KAAI,OACJV,UAAS,wBACTW,SAAU,SAAAjB,GAAC,OAAI,EAAKvC,SAAS,CAAE2C,YAAaJ,EAAEC,OAAOC,SACrDgB,QAAS,SAAAlB,GAAC,MAAgB,UAAXA,EAAEmB,MAA8B,UAAVnB,EAAEoB,IAAmB,EAAK/B,SAASW,GAAK,QAG7EzD,KAAKmD,MAAMpB,KAAK+C,KAAI,SAAA/C,GAChB,OACIA,EAAKC,gBAED,uBAAK+B,UAAS,4BACV,wBAAMA,UAAS,6CAAgDhC,EAAKgB,UAGxE,uBAAKgB,UAAS,wBAAyBhC,EAAKwB,KAAO,YAAc,gBAC7D,yBAAIxB,EAAKgD,MACT,qBAAGhB,UAAS,QAAShC,EAAKwB,KAAO,sBAAwB,2BAA6BxB,EAAKgB,gBAQ9H,EAxGCE,CAAa+B,EAAAA,WC6CnB,EAjDMC,SAAAA,GACF,WAAY/B,GAAQ,IAAD,SACf,cAAMA,IAAN,MAEKC,MAAQ,CACT+B,cAAeC,WAAWC,WAJf,GADjBH,EAAAA,EAAAA,GAAAA,EAAAA,GAOD,kBAuCA,OAvCA,EAEDI,UAAA,SAAU5B,GAIN,GAAY,WAHFA,EAAEmB,MAAQnB,EAAEoB,KAGtB,CAEA,IAAIlD,EAJa,4GAIQ2D,KAAKtF,KAAKkD,MAAMqC,YAEzB,OAAZ5D,GACAS,MAAM,mCACNpC,KAAKkD,MAAMwB,SAAS,KAEpB1E,KAAKkD,MAAMsC,UAAU7D,EAAQ,M,EAcrCmC,OAAA,WAAW,IAAD,OACN,OACI,yBACIH,MAAO3D,KAAKkD,MAAMqC,WAClBb,SAAU,SAAAjB,GAAC,OAAI,EAAKP,MAAMwB,SAASjB,EAAEC,OAAOC,QAC5CgB,QAAS,SAAAlB,GAAC,OAAI,EAAK4B,UAAU5B,IAC7Be,YAAY,oBACZC,KAAK,OACLV,UAAU,8EAGrB,EA9CCkB,CAAeD,EAAAA,W,mBCmErB,EAhEMS,SAAAA,GACF,aAAe,IAAD,SACV,sBAEKtC,MAAQ,CACTuC,YAAa,GAJP,GADZD,EAAAA,EAAAA,GAAAA,EAAAA,GAOD,kBAsDA,OAtDA,EAEDJ,UAAA,WACIrF,KAAKkD,MAAMyC,UACd,EAEDC,WAAA,WACI5F,KAAKkD,MAAM2C,WACd,EAEDC,YAAA,WACQ9F,KAAKkD,MAAMrB,UACX7B,KAAKkB,SAAS,CAAC6E,UAAU,IACzB/F,KAAKkD,MAAM8C,mBAAmBhG,KAAKmD,MAAMuC,eAEhD,EAED5B,OAAA,WAAW,IAAD,OACN,OACI,uBAAKC,UAAS,oDAAqD/D,KAAKkD,MAAMrB,QAAU,eAAiB,gBAA3F,sBAEN7B,KAAKkD,MAAMrB,QAEP,gCAEQ7B,KAAKkD,MAAM+C,QAEP,sBAAIjC,QAAS,WAAQ,EAAK4B,eACtB,gBAAC,IAAD,CAAiBxB,KAAM8B,EAAAA,OAG3B,sBAAIlC,QAAS,WAAQ,EAAKqB,cACtB,gBAAC,IAAD,CAAiBjB,KAAM+B,EAAAA,OAIzC,GAGN,gBAAC,KAAD,CACIC,UAAQ,EACRC,IAAK,EACLC,IAAKtG,KAAKkD,MAAMqD,SAChB5C,MAAO3D,KAAKmD,MAAM4C,SAAW/F,KAAKmD,MAAMuC,YAAc1F,KAAKkD,MAAMsD,SACjEC,eAAgB,WAAY,EAAKvD,MAAMrB,SAAU,EAAKX,SAAS,CAAC6E,UAAU,KAC1ErB,SAAU,SAAC8B,GAAmB,EAAKtD,MAAMrB,SAAW,EAAKX,SAAS,CAAEwE,YAAac,KACjFE,cAAe1G,KAAK8F,YAAYa,KAAK3G,MACrC+D,UAAS,GACT6C,WAAY,CAACC,gBAAiB,SAC9BC,UAAW,CAACD,gBAAiB,QAC7BE,YAAa,CAACF,gBAAiB,QAASG,OAAQ,YAI/D,EA7DCvB,CAAsBT,EAAAA,WCyK5B,EAvKMiC,SAAAA,GACF,WAAY/D,GAAQ,IAAD,SACf,cAAMA,IAAN,MAEKC,MAAQ,CACT+D,eAAgBC,YAAY/B,UAC5BvD,SAAS,EACTF,SAAS,EACTyF,QAAQ,EACRb,UAAU,EACVC,SAAU,EACVjB,WAAY,GACZnC,aAAc,IAAIR,GAAJ,UAAuB,EAAKM,MAAMtC,SAGpDb,EAAAA,GAAY,gBAAgB,YAAW,IAATsB,EAAQ,EAARA,GAC1B,EAAKH,SAAS,CAAEqE,WAAY,GAAI5D,QAASN,EAAI4E,SAAS,IACtD,EAAKoB,oBAGTtH,EAAAA,GAAY,oBAAoB,YAAuD,IAArD8B,EAAoD,EAApDA,QAASL,EAA2C,EAA3CA,KAAMC,EAAqC,EAArCA,MAAOC,EAA8B,EAA9BA,SAAUC,EAAoB,EAApBA,QAASC,EAAW,EAAXA,MACvE,EAAKV,SAAS,CACVsF,SAAUhF,EAAMG,QAAAA,EAASE,QAASJ,EAAOC,SAAAA,EAAUE,MAAAA,EAAOqE,SAAS,IAGvE,EAAKqB,oBAAoBzF,GACzB,EAAKmE,mBAAmB,EAAK7C,MAAMqD,aAGvCzG,EAAAA,GAAY,kBAAkB,SAAAyB,GAAI,OAAI,EAAK2B,MAAMiE,OAAOG,OAAO/F,MAE/D,EAAKgG,gBA9BU,GADjBP,EAAAA,EAAAA,GAAAA,EAAAA,GAgCD,kBAoIA,OApIA,EAEDK,oBAAA,SAAoBzF,GAAkB,IAAD,gBAAjBA,IAAAA,GAAU,GAC1B7B,KAAKkB,SAAS,CAACW,SAAS,IAEpBA,GACA7B,KAAKkB,SAAS,CAAEW,SAAS,EAAMqF,eAAgBC,aAAY,WAC/C,EAAKhE,MAAMiE,QACX,EAAKjE,MAAMC,aAAaJ,WAAW,EAAKG,MAAMiE,OAAOK,oBAE1D,MAGXzH,KAAKwH,eAAc,WACfL,aAAY,WACR,EAAKjG,SAAS,CACVwG,uBAAwB,EAAKvE,MAAMiE,OAAOK,qBAE/C,SAEV,EAEDzB,mBAAA,SAAmBQ,GAAW,IAAD,OACzBxG,KAAKwH,eAAc,WACX,EAAKrE,MAAMtB,UACX,EAAKsB,MAAMiE,OAAOG,OAAOf,GACzB,EAAKrD,MAAMC,aAAaJ,WAAWwD,GAAU,QAGxD,EAEDgB,cAAA,SAAclH,GAAa,IAAD,OACtB,QADsB,IAAZA,IAAAA,GAAK,IACJ,IAAPA,EACA,IAAIqH,EAAiBR,aAAY,WACzB,EAAKhE,MAAMiE,QACP,cAAe,EAAKjE,MAAMiE,SAC1BQ,cAAcD,GAEd,EAAKxE,MAAMiE,OAAO/B,YAClB,EAAKlC,MAAMiE,OAAOG,OAAO,EAAKpE,MAAME,WAEpC8B,YAAW,WACP,EAAKhC,MAAMiE,OAAOS,WACnB,QAGZ,SAEH,IAAIF,EAAiBR,aAAY,WACzB,EAAKhE,MAAMiE,QACP,cAAe,EAAKjE,MAAMiE,SAC1BQ,cAAcD,GAEdrH,OAGT,KAEV,EAED+G,eAAA,WAAkB,IAAD,OACbrH,KAAKwH,eAAc,WACf,EAAKtG,SAAS,CAAEqF,SAAU,EAAKpD,MAAMiE,OAAOU,oBAEnD,EAEDC,aAAA,SAAatE,GACTzD,KAAKkB,SAAS,CAAEkG,OAAQ3D,EAAEC,SAC1B1D,KAAKqH,kBACR,EAEDW,WAAA,WACQhI,KAAKmD,MAAMtB,UACX7B,KAAKkB,SAAS,CAAE+E,SAAS,IACzBjG,KAAKmD,MAAMiE,OAAO/B,cAEzB,EAED4C,YAAA,WACQjI,KAAKmD,MAAMtB,UACX7B,KAAKkB,SAAS,CAAE+E,SAAS,IACzBjG,KAAKmD,MAAMiE,OAAOxB,eAEzB,EAED9B,OAAA,WAAW,IAAD,OAWN,OACI,uBAAKC,UAAU,kCACX,gBAAC,EAAD,CACIwB,WAAYvF,KAAKmD,MAAMoC,WACvBb,SAAU,SAAAa,GAAU,OAAI,EAAKrE,SAAS,CAAEqE,WAAAA,KACxCC,UAAW,SAACnE,GAAS,EAAK8B,MAAMC,aAAaP,SAASxB,MAItDrB,KAAKmD,MAAMxB,QACP,uBAAKoC,UAAU,iBACX,uBAAKA,UAAU,+BACX,gBAACmE,EAAA,EAAD,CACIvG,QAAS3B,KAAKmD,MAAMxB,QACpBwG,KAxBf,CACTC,OAAQ,OACRC,MAAO,OACPC,WAAY,CACRC,SAAU,EACVC,KAAM,EACNC,SAAU,IAmBUC,QAAS,SAAAjF,GAAC,OAAI,EAAKsE,aAAatE,MAGpC,uBAAKM,UAAS,UAGlB,gBAAC,EAAD,CACIkC,QAASjG,KAAKmD,MAAM8C,QACpBpE,QAAS7B,KAAKmD,MAAMtB,QACpBuF,OAAQpH,KAAKmD,MAAMiE,OACnBb,SAAUvG,KAAKmD,MAAMoD,SACrBC,SAAUxG,KAAKmD,MAAMuE,uBACrB1B,mBAAoB,SAACQ,GAAe,EAAKR,mBAAmBQ,IAC5Db,OAAQ,kBAAM,EAAKqC,cACnBnC,QAAS,kBAAM,EAAKoC,kBAG1B,KAIrB,EApKChB,CAAkBjC,EAAAA,WCGlB2D,EAA8B,oBAAXC,OA+EzB,EA7EMC,SAAAA,GACF,WAAY3F,GAAQ,IAAD,SACf,cAAMA,IAAN,MAEKC,MAAQ,CACT2F,WAAW,EACX/D,KAAM,GACN5D,WAAW,EACXO,SAAU,KACVd,OAAQ,MARG,GADjBiI,EAAAA,EAAAA,GAAAA,EAAAA,GAWD,kBA+DA,OA/DA,EAEDE,SAAA,WAAY,IAAD,EACP,GAAI/I,KAAKmD,MAAM4B,KAAKiE,OAAOtG,OAAS,EAApC,CACI1C,KAAKkB,SAAS,CAAE4H,WAAW,IAO/B,IAAMlI,GAASqI,EAAAA,EAAAA,IAAG,IAAD,UAAIC,GAAYC,kBAAhB,QAA8B,qCAAuC,CAClFC,MAAO,CACHC,OAAQV,EAAYC,OAAOU,SAASC,SAASC,QAAQ,mBAAmB,IAAM,KAC9EzE,KAAM/E,KAAKmD,MAAM4B,QAIzB,IAAIrE,EAAaV,KAAMY,GAEvBZ,KAAKkB,SAAS,CAAEN,OAAAA,EAAQwC,aAAc,IAAIR,EAAa5C,KAAMY,UAdzDwB,MAAM,iCAeb,EAED6B,WAAA,WACIjE,KAAKkB,SAAS,CACVgD,UAAYlE,KAAKmD,MAAMe,YAE9B,EAEDJ,OAAA,WAAU,IAAD,OACL,OACI,gCAEU9D,KAAKmD,MAAM2F,UAkBT,gBAACW,EAAA,EAAD,CAAOtF,MAAM,eAAeuF,KAAM1J,KAAKmD,MAAM2F,UAAWa,QAAS,CAAC,0BAAQ5F,UAAU,qCAAqCC,QAAS,kBAAM,EAAK+E,aAA3E,UAC9D,yBAAOxE,aAAY,MAASE,KAAK,OAAOV,UAAU,2BAA2BS,YAAY,WAAWE,SAAU,SAAAjB,GAAC,OAAI,EAAKvC,SAAS,CAAC6D,KAAMtB,EAAEC,OAAOC,SAASA,MAAO3D,KAAKmD,MAAM4B,QAjBhL/E,KAAKmD,MAAMhC,UAEP,uBAAK4C,UAAU,uEACX,gBAAC,EAAD,CACInD,OAAQZ,KAAKmD,MAAMvC,SAGvB,gBAAC,EAAD,CACIA,OAAQZ,KAAKmD,MAAMvC,OACnBc,SAAU1B,KAAKmD,MAAMzB,SACrBa,OAAQvC,KAAKmD,MAAMZ,UAI3B,sBAAIwB,UAAU,2CAAd,iBAOZ,gBAAC6F,EAAA,EAAD,CACIC,eAAgB,CACZC,MAAO,sBAK1B,EA1ECjB,CAAY7D,EAAAA","sources":["webpack://gatsby-starter-default/./src/components/WatchTogether/EventBus.js","webpack://gatsby-starter-default/./src/components/WatchTogether/EventHandler.js","webpack://gatsby-starter-default/./src/components/WatchTogether/EventEmitter.js","webpack://gatsby-starter-default/./src/components/WatchTogether/Chat.js","webpack://gatsby-starter-default/./src/components/WatchTogether/Search.js","webpack://gatsby-starter-default/./src/components/WatchTogether/VideoControls.js","webpack://gatsby-starter-default/./src/components/WatchTogether/WatchArea.js","webpack://gatsby-starter-default/./src/components/WatchTogether/app.js"],"sourcesContent":["class EventBus {\n    constructor() {\n        this.watchers = {};\n    }\n\n    emit(eventName, data) {\n        if (! eventName in this.watchers) return;\n        \n        this.watchers[eventName].forEach(fn => {\n            fn(data);\n        });\n    }   \n    \n    on(eventName, callback) {\n        if (! (eventName in this.watchers)) {\n            this.watchers[eventName] = [];\n        }\n        \n        this.watchers[eventName].push(callback);\n    }\n}\n\nexport default new EventBus","import EventBus from \"./EventBus\";\n\nexport default class EventHandler {\n    constructor(app, socket) {\n        this.app = app;\n        this.socket = socket;\n        \n        this.connect();\n        this.disconnect();\n        \n        this.socket.onAny((event, args) => {            \n            if (event in this) {\n                this[event](args);\n            }\n        });\n    }\n    \n    connect() {\n        this.socket.on('connect', () => {\n            this.app.setState({ connected: true });\n        });\n    }\n    \n    disconnect() {\n        this.socket.on('disconnect', () => {\n            this.app.setState({ connected: false });\n        });\n    }\n    \n    set_video_id({id}) {\n        EventBus.emit('set_video_id', {id});\n    }\n    \n    cmd_clear_chat() {\n        EventBus.emit('cmd_clear_chat');\n    }\n    \n    initial_response({time, owner, socketId, videoId, users}) {\n        let isOwner = owner === socketId;\n        EventBus.emit('initial_response', {isOwner, time, owner, socketId, videoId, users});\n    }\n    \n    system_message(chat) {\n        EventBus.emit('receive_chat', {isSystemMessage: true, ...chat});\n    }\n    \n    chat_message(chat) {\n        EventBus.emit('receive_chat', chat);\n    }\n    \n    disconnect_reason({reason}) {\n        alert(reason);\n    }\n    \n    set_video_time(time) {\n        EventBus.emit('set_video_time', time);\n    }\n    \n    presence_update_join({owner, socketId, videoId, users}) {\n        EventBus.emit('presence_update', { online: Object.keys(users).length });\n    }\n    \n    presence_update_leave({videoId, users}) {\n        EventBus.emit('presence_update', { online: Object.keys(users).length });\n    }\n}","import EventBus from './EventBus'\n\nexport default class EventEmitter {\n    constructor(app, socket) {\n        this.app = app;\n        this.socket = socket;\n    }\n    \n    disconnect() {\n        this.socket.disconnect();\n    }\n    \n    setVideo(id) {\n        this.socket.emit('set_video_id', {id});\n        EventBus.emit('set_video_id', {id});\n    }\n\n    sendChat(message) {\n        this.socket.emit('send_chat', {message});\n    }\n    \n    updateTime(time, emit = false) {\n        this.socket.emit('set_video_time', {time, emit});\n    }\n}","import React from 'react';\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport {faLock, faUnlock} from \"@fortawesome/pro-solid-svg-icons\";\nimport EventEmitter from \"./EventEmitter\";\nimport EventBus from \"./EventBus\";\n\nclass Chat extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        this.state = {\n            socketId: null,\n            online: 0,\n            chat: [],\n            eventEmitter: new EventEmitter(this, this.props.socket)\n        }\n        \n        EventBus.on('initial_response', ({time, owner, socketId, videoId, users}) => {\n            this.setState({ isOwner: owner, socketId, startTime: time, videoId, online: Object.keys(users).length })\n        })\n        \n        EventBus.on('receive_chat', chat => {\n            this.pushChat({...chat, self: chat.sender === this.state.socketId});\n        })\n        \n        EventBus.on('presence_update', ({online}) => {\n            this.setState({ online })\n        })\n        \n        EventBus.on('cmd_clear_chat', () => {\n            this.setState({chat: []});\n        })\n    }\n\n    sendChat(e) {\n        let message = e.target.value;\n\n        this.clearMessage();\n\n        this.state.eventEmitter.sendChat(message);\n    }\n\n    clearMessage() {\n        this.setState({\n            chatMessage: ''\n        })\n    }\n\n    pushChat(chat) {\n        this.setState({\n            chat: [chat, ...this.state.chat]\n        })\n    }\n    \n    render () {\n        return (\n            <div className=\"bg-black dark:bg-gradient-to-tr dark:from-gray-800 dark:via-gray-700 dark:to-gray-900 grow text-white p-3 flex flex-col\">\n                <div className={`flex justify-between`}>\n                    <div className={`flex`}>\n                        {\n                            this.state.isOwner\n                                ?\n                                <div className={`flex`}>\n                                    <div onClick={() => this.toggleLock()}>\n                                        {\n                                            this.props.isLocked \n                                            ?\n                                                <FontAwesomeIcon title={`Unlock room`} icon={faLock} />\n                                            :\n                                                <FontAwesomeIcon title={`Lock room`} icon={faUnlock} />\n                                        }\n                                    </div>\n                                </div>\n                                :\n                                \"\"\n                        }\n                    </div>\n\n                    <p className=\"text-right\">{ this.state.online } Online Now</p>\n                </div>\n\n                <div className={`flex flex-col flex-col-reverse grow mt-3`}>\n                    <input\n                        autoComplete={`off`}\n                        value={this.state.chatMessage}\n                        placeholder={`Type to chat...`}\n                        type={`text`}\n                        className={`w-full text-black p-3`}\n                        onChange={e => this.setState({ chatMessage: e.target.value })}\n                        onKeyUp={e => (e.code === 'Enter' || e.key === 'Enter') ? this.sendChat(e) : null}\n                    />\n                    {\n                        this.state.chat.map(chat => {\n                            return (\n                                chat.isSystemMessage\n                                    ?\n                                    <div className={`my-3 flex justify-center`}>\n                                        <span className={`text-white text-sm border-t border-b py-2`}>{chat.message}</span>\n                                    </div>\n                                    :\n                                    <div className={`my-3 flex flex-col  ${chat.self ? 'items-end' : 'items-start'}`}>\n                                        <p>{chat.name}</p>\n                                        <p className={`p-3 ${chat.self ? 'bg-white text-black' : 'bg-gray-600 text-white'}`}>{chat.message}</p>\n                                    </div>\n                            )\n                        })\n                    }\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Chat","import React from 'react';\n\nclass Search extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        this.state = {\n            searchTimeout: setTimeout.prototype\n        }\n    }\n    \n    playVideo(e) {\n        let key = e.code || e.key;\n        let videoRegex = /^.*(?:(?:youtu\\.be\\/|v\\/|vi\\/|u\\/\\w\\/|embed\\/|shorts\\/)|(?:(?:watch)?\\?v(?:i)?=|\\&v(?:i)?=))([^#\\&\\?]*).*/;\n        \n        if (key !== 'Enter') return;\n        \n        let videoId = videoRegex.exec(this.props.searchTerm);\n        \n        if (videoId === null) {\n            alert('Enter a valid YouTube video URL');\n            this.props.onChange(\"\");\n        } else {\n            this.props.onVideoId(videoId[1]);\n        }\n    }\n\n    // search() {\n    //     clearTimeout(this.state.searchTimeout);\n    //    \n    //     const search = () => {\n    //         console.log('Searching...');\n    //     };\n    //\n    //     this.state.searchTimeout = setTimeout(search, 1000);\n    // }\n    \n    render () {\n        return (\n            <input\n                value={this.props.searchTerm}\n                onChange={e => this.props.onChange(e.target.value)}\n                onKeyUp={e => this.playVideo(e)}\n                placeholder=\"Search YouTube...\"\n                type=\"text\"\n                className=\"text-black placeholder-gray-500 border-4 border-black w-full p-2 text-lg\"\n            />\n        )\n    }\n}\n\nexport default Search","import React from 'react';\nimport {FontAwesomeIcon} from \"@fortawesome/react-fontawesome\";\nimport { faPause, faPlay } from \"@fortawesome/pro-solid-svg-icons\";\nimport Slider from \"rc-slider\";\n\nclass VideoControls extends React.Component {\n    constructor() {\n        super();\n        \n        this.state = {\n            newPosition: 0,\n        }\n    }\n    \n    playVideo() {\n        this.props.onPlay();\n    }\n    \n    pauseVideo() {\n        this.props.onPause();\n    }\n    \n    afterChange() {\n        if (this.props.isOwner) {\n            this.setState({dragging: false});\n            this.props.updateSeekPosition(this.state.newPosition);\n        }\n    }\n    \n    render () {\n        return (\n            <div className={`flex w-full bg-[#00000085] text-white p-4 gap-4 ${this.props.isOwner ? '-mt-[3.6rem]' : '-mt-[2.8rem]'} z-10 items-center`}>\n                {\n                    this.props.isOwner\n                    ?\n                        <>\n                            {\n                                this.props.playing\n                                ?\n                                    <h1 onClick={() => { this.pauseVideo() }}>\n                                        <FontAwesomeIcon icon={faPause} />\n                                    </h1>\n                                :\n                                    <h1 onClick={() => { this.playVideo() }}>\n                                        <FontAwesomeIcon icon={faPlay} />\n                                    </h1>    \n                            }\n                        </>\n                    : \"\"    \n                }\n\n                <Slider\n                    progress\n                    min={0}\n                    max={this.props.duration}\n                    value={this.state.dragging ? this.state.newPosition : this.props.position}\n                    onBeforeChange={() => { if (this.props.isOwner){ this.setState({dragging: true}) }}}\n                    onChange={(position) => { if (this.props.isOwner) { this.setState({ newPosition: position }) } }}\n                    onAfterChange={this.afterChange.bind(this)}\n                    className={``}\n                    trackStyle={{backgroundColor: 'white'}}\n                    railStyle={{backgroundColor: 'gray'}}\n                    handleStyle={{backgroundColor: 'white', border: 'none'}}\n                />\n            </div>\n        )\n    }\n}\n\nexport default VideoControls","import React from 'react'\nimport Search from \"./Search\";\nimport YouTube from \"react-youtube\";\nimport VideoControls from \"./VideoControls\";\nimport EventEmitter from './EventEmitter';\nimport EventBus from \"./EventBus\";\n\nclass WatchArea extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            updateInterval: setInterval.prototype,\n            isOwner: false,\n            videoId: false,\n            player: false,\n            duration: false,\n            position: 0,\n            searchTerm: '',\n            eventEmitter: new EventEmitter(this, this.props.socket)\n        }\n\n        EventBus.on('set_video_id', ({id}) => {\n            this.setState({ searchTerm: \"\", videoId: id, playing: true });\n            this.updateDuration();\n        })\n        \n        EventBus.on('initial_response', ({isOwner, time, owner, socketId, videoId, users}) => {\n            this.setState({\n                position: time, videoId, isOwner: owner, socketId, users, playing: true\n            })\n\n            this.startUpdateInterval(isOwner);\n            this.updateSeekPosition(this.state.position);\n        })\n        \n        EventBus.on('set_video_time', time => this.state.player.seekTo(time))\n        \n        this.waitForPlayer();\n    }\n\n    startUpdateInterval(isOwner = false) {\n        this.setState({isOwner: true});\n        \n        if (isOwner) {\n            this.setState({ isOwner: true, updateInterval: setInterval(() => {\n                    if (this.state.player) {\n                        this.state.eventEmitter.updateTime(this.state.player.getCurrentTime());\n                    }\n                }, 10)});\n        }\n\n        this.waitForPlayer(() => {\n            setInterval(() => {\n                this.setState({\n                    positionForProgressBar: this.state.player.getCurrentTime()\n                })\n            }, 100);\n        });\n    }\n\n    updateSeekPosition(position) {\n        this.waitForPlayer(() => {\n            if (this.state.isOwner) {\n                this.state.player.seekTo(position);\n                this.state.eventEmitter.updateTime(position, true);\n            }\n        })\n    }\n\n    waitForPlayer(fn = false) {\n        if (fn === false) {\n            let playerInterval = setInterval(() => {\n                if (this.state.player) {\n                    if ('playVideo' in this.state.player) {\n                        clearInterval(playerInterval);\n\n                        this.state.player.playVideo();\n                        this.state.player.seekTo(this.state.startTime);\n\n                        setTimeout(() => {\n                            this.state.player.unMute();\n                        }, 800);\n                    }\n                }\n            }, 50);\n        } else {\n            let playerInterval = setInterval(() => {\n                if (this.state.player) {\n                    if ('playVideo' in this.state.player) {\n                        clearInterval(playerInterval);\n\n                        fn();\n                    }\n                }\n            }, 50);\n        }\n    }\n\n    updateDuration() {\n        this.waitForPlayer(() => {\n            this.setState({ duration: this.state.player.getDuration() });\n        });\n    }\n\n    onVideoReady(e) {\n        this.setState({ player: e.target });\n        this.updateDuration();\n    }\n\n    handlePlay() {\n        if (this.state.isOwner) {\n            this.setState({ playing: true });\n            this.state.player.playVideo();\n        }\n    }\n\n    handlePause() {\n        if (this.state.isOwner) {\n            this.setState({ playing: false });\n            this.state.player.pauseVideo();\n        }\n    }\n\n    render () {\n        const opts = {\n            height: '100%',\n            width: '100%',\n            playerVars: {\n                controls: 0,\n                mute: 1,\n                autoplay: 1\n            }\n        };\n        \n        return (\n            <div className=\"lg:col-span-2 grow-0 space-x-1\">\n                <Search \n                    searchTerm={this.state.searchTerm}\n                    onChange={searchTerm => this.setState({ searchTerm })}\n                    onVideoId={(id) => { this.state.eventEmitter.setVideo(id) }}\n                />\n\n                {\n                    this.state.videoId ?\n                        <div className=\"flex flex-col\">\n                            <div className=\"aspect-w-16 aspect-h-9 mt-4\">\n                                <YouTube \n                                    videoId={this.state.videoId}\n                                    opts={opts}\n                                    onReady={e => this.onVideoReady(e)}\n                                />\n                                \n                                <div className={`flex`}></div>\n                            </div>\n\n                            <VideoControls\n                                playing={this.state.playing}\n                                isOwner={this.state.isOwner}\n                                player={this.state.player}\n                                duration={this.state.duration}\n                                position={this.state.positionForProgressBar}\n                                updateSeekPosition={(position) => { this.updateSeekPosition(position) }}\n                                onPlay={() => this.handlePlay()}\n                                onPause={() => this.handlePause()}\n                            ></VideoControls>\n                        </div>\n                        : ''\n                }\n            </div>\n        )\n    }\n}\n\nexport default WatchArea","import * as React from \"react\"\nimport Layout from \"../Layout\";\nimport { io } from \"socket.io-client\";\nimport EventHandler from './EventHandler';\nimport EventEmitter from './EventEmitter';\nimport Modal from \"../Modal\";\nimport {Helmet} from \"react-helmet\";\nimport Chat from \"./Chat\";\nimport WatchArea from \"./WatchArea\";\n\nconst isBrowser = typeof window !== \"undefined\";\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        this.state = {\n            modalOpen: true,\n            name: \"\",\n            connected: false,\n            socketId: null,\n            socket: null,\n        }\n    }\n\n    joinRoom() {\n        if (this.state.name.trim().length > 3) {\n            this.setState({ modalOpen: false });\n        } else {\n            alert('Please enter a valid name...');\n            \n            return;\n        }\n        \n        const socket = io(`${process.env.SOCKET_URL ?? 'https://watch-together.welford.me'}`, {\n            query: {\n                roomid: isBrowser ? window.location.pathname.replace('/watch-together/','') : null,\n                name: this.state.name\n            }\n        });\n\n        new EventHandler(this, socket);\n\n        this.setState({ socket, eventEmitter: new EventEmitter(this, socket) });\n    }\n    \n    toggleLock() {\n        this.setState({\n            isLocked: ! this.state.isLocked\n        })\n    }\n\n    render() {        \n        return (\n            <>\n                {\n                    ! this.state.modalOpen\n                        ?\n                        this.state.connected\n                            ?\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 md:gap-4 grow flex l\">\n                                <WatchArea\n                                    socket={this.state.socket}\n                                ></WatchArea>\n\n                                <Chat\n                                    socket={this.state.socket}\n                                    socketId={this.state.socketId}\n                                    online={this.state.online}\n                                />\n                            </div>\n                            :\n                            <h1 className=\"text-4xl text-center dark:text-gray-300\">Disconnected.</h1>\n                        :\n                        <Modal title=\"Enter a name\" open={this.state.modalOpen} buttons={[<button className=\"bg-black text-white px-3 py-4 w-36\" onClick={() => this.joinRoom()}>Join</button>]}>\n                            <input autoComplete={`off`} type=\"text\" className=\"w-full px-2 py-3 text-lg\" placeholder=\"Jane Doe\" onChange={e => this.setState({name: e.target.value})} value={this.state.name} />\n                        </Modal>\n                }\n\n                <Helmet\n                    htmlAttributes={{\n                        class: 'watch-together',\n                    }}\n                /> \n            </>    \n        );\n    }\n}\n\nexport default App"],"names":["EventBus","this","watchers","emit","eventName","data","forEach","fn","on","callback","push","EventHandler","app","socket","connect","disconnect","onAny","event","args","setState","connected","set_video_id","id","cmd_clear_chat","initial_response","time","owner","socketId","videoId","users","isOwner","system_message","chat","isSystemMessage","chat_message","disconnect_reason","reason","alert","set_video_time","presence_update_join","online","Object","keys","length","presence_update_leave","EventEmitter","setVideo","sendChat","message","updateTime","Chat","props","state","eventEmitter","startTime","pushChat","self","sender","e","target","value","clearMessage","chatMessage","render","className","onClick","toggleLock","isLocked","title","icon","faLock","faUnlock","autoComplete","placeholder","type","onChange","onKeyUp","code","key","map","name","React","Search","searchTimeout","setTimeout","prototype","playVideo","exec","searchTerm","onVideoId","VideoControls","newPosition","onPlay","pauseVideo","onPause","afterChange","dragging","updateSeekPosition","playing","faPause","faPlay","progress","min","max","duration","position","onBeforeChange","onAfterChange","bind","trackStyle","backgroundColor","railStyle","handleStyle","border","WatchArea","updateInterval","setInterval","player","updateDuration","startUpdateInterval","seekTo","waitForPlayer","getCurrentTime","positionForProgressBar","playerInterval","clearInterval","unMute","getDuration","onVideoReady","handlePlay","handlePause","YouTube","opts","height","width","playerVars","controls","mute","autoplay","onReady","isBrowser","window","App","modalOpen","joinRoom","trim","io","process","SOCKET_URL","query","roomid","location","pathname","replace","Modal","open","buttons","Helmet","htmlAttributes","class"],"sourceRoot":""}